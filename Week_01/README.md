学习笔记

# JDK 内置命令行工具和图形化工具



| 工具           | 说明                             |
| -------------- | -------------------------------- |
| jps/jinfo      | 查看java 进程                    |
| jstat          | 查看JVM 内部gc 相关信息          |
| jmap           | 查看heap 或类占用空间统计        |
| jstack         | 查看线程信息                     |
| jcmd           | 执行JVM 相关分析命令（整合命令） |
| jrunscript/jjs | 执行js 命令                      |



## ``jps``



```
PS E:\JavaCourse\code_space\JAVA-000\Week_01> jps
10760
16904
4744 Jps
# 不详细
```

``jps带参数``

```
PS E:\JavaCourse\code_space\JAVA-000\Week_01> jps -lmv
10760  -Dfile.encoding=UTF-8 -Xms128m -Xmx1024m -XX:MaxPermSize=256m
16904  exit -Xms128m -Xmx1005m -XX:ReservedCodeCacheSize=240m -XX:+UseConcMarkSweepGC -XX:SoftRefLRUPolicyMSPerMB=50 -ea -XX:CICompilerCount=2 -Dsun.io.useCanonPrefixCache=false -Djdk.http.auth.tunneling.disabledSchemes="" -XX:+HeapDumpOnOutOfMemoryError -XX:-OmitStackTraceInFastThrow -Djdk.attach.allowAttachSelf=true -Dkotlinx.coroutines.debug=off -Djdk.module.illegalAccess.silent=true -Djb.vmOptionsFile=C:\Users\hanky\AppData\Roaming\JetBrains\IdeaIC2020.2\idea64.exe.vmoptions -Djava.library.path=C:\Program Files\JetBrains\IntelliJ IDEA Community Edition 2020.2.3\jbr\\bin;C:\Program Files\JetBrains\IntelliJ IDEA Community Edition 2020.2.3\jbr\\bin\server -Didea.platform.prefix=Idea -Didea.jre.check=true -Dide.native.launcher=true -Didea.vendor.name=JetBrains -Didea.paths.selector=IdeaIC2020.2 -XX:ErrorFile=C:\Users\hanky\java_error_in_idea_%p.log -XX:HeapDumpPath=C:\Users\hanky\java_error_in_idea.hprof
232 sun.tools.jps.Jps -lmv -Denv.class.path=.;C:\Program Files\Java\jdk1.8.0_131\lib\dt.jar;C:\Program Files\Java\jdk1.8.0_131\lib\tools.jar; -Dapplication.home=C:\Program Files\Java\jdk1.8.0_131 -Xms8m
```

##  ``jinfo``

```
jinfo 16904
```

## ```jstat```



```
jstat -help
Usage: jstat -help|-options
       jstat -<option> [-t] [-h<lines>] <vmid> [<interval> [<count>]]
```





```
PS E:\JavaCourse\code_space\JAVA-000\Week_01> jstat -gc 16904 1000 1000
 S0C    S1C    S0U    S1U      EC       EU        OC         OU       MC     MU    CCSC   CCSU   YGC     YGCT    FGC    FGCT     GCT
24704.0 24704.0  0.0   8555.2 198144.0 60097.1   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60152.3   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60163.3   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60174.2   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60174.2   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60187.8   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
24704.0 24704.0  0.0   8555.2 198144.0 60198.2   494828.0   395382.3  456832.0 442116.2 60276.0 54784.9    721   10.955  22     20.422   31.377
```



```
# 百分比
jstat -gcutil 16904 1000 1000
  S0     S1     E      O      M     CCS    YGC     YGCT    FGC    FGCT     GCT
  0.00   0.00  97.74  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.74  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.81  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.82  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.83  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.83  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.83  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.84  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.85  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.85  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.86  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.86  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.94  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.94  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.95  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  97.95  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  99.28  56.50  96.46  90.49    721   10.955    23   23.504   34.459
  0.00   0.00  99.36  56.50  96.46  90.49    721   10.955    23   23.504   34.459
 68.96   0.00   2.69  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  11.19  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  20.36  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  21.61  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  24.12  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  38.78  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  40.93  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  40.93  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  40.94  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  40.99  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.22  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.22  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.24  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.24  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.25  56.50  96.48  90.52    722   10.981    23   23.504   34.484
 68.96   0.00  42.25  56.50  96.48  90.52    722   10.981    23   23.504   34.484
```



## ``jmap``

```
jmap -histo 16904
jmap -heap pid
```

## jstack





## ``jcmd``

```
jcmd 16904 help
```

```
**
jcmd pid VM.info 
```

# JDK内置命令行工具与图形化工具

| 工具or命令     | 简介                                                         |
| -------------- | ------------------------------------------------------------ |
| jps/jinfo      | 查看java进程                                                 |
| jstat          | 查看JVM内存gc的相关信息，jstat -gc pid 收集时间间隔(ms) 收集次数 |
| jmap           | 查看heap或类占用空间，jmap -heap pid                         |
| jstack         | 查看线程信息 ，jstack -l pid                                 |
| jcmd           | 执行JVM相关分析命令（整合性的命令），jcmd pid 参数           |
| jrunscript/jjs | 执行js命令                                                   |
| jsconsole工具  | 查看堆内存使用量，线程，类，CPU占用率                        |
| jvisualvm工具  | 同样可以查看堆，线程，类，CPU占用率，另外有快照功能，进行瞬时分析 |
| visualGC工具   | 主要对堆和GC情况进行详细展示，可以在idea以插件形式安装       |
| jmc工具        | 对应用进行管理，监控，分析以及故障排查的工具套件，很强       |



# 各个GC的简介

| 收集器            | 串行/并行/并发 | 新生代/老年代 | 收集算法          | 目标       | 适用场景                                  |
| ----------------- | -------------- | ------------- | ----------------- | ---------- | ----------------------------------------- |
| Serial            | 串行           | 新生代        | 复制算法          | 响应优先   | 单CPU下的Client模式                       |
| Serial Old        | 串行           | 老年代        | 标记整理          | 响应优先   | 单CPU下的Client模式，CMS后备预案          |
| ParNew            | 并行           | 新生代        | 复制算法          | 响应优先   | 多CPU下的Server模式，与CMS配合            |
| Parallel Scavenge | 并行           | 新生代        | 复制算法          | 吞吐量优先 | 在后台运算而不需要太多交互的任务          |
| Parallel Old      | 并行           | 老年代        | 标记整理          | 吞吐量优先 | 在后台运算而不需要太多交互的任务          |
| CMS               | 并发           | 老年代        | 标记清除          | 响应优先   | 集中在互联网站或B/S系统服务端上的java应用 |
| G1                | 并发           | both          | 标记整理+复制算法 | 响应优先   | 面向服务端应用，未来替换CMS               |